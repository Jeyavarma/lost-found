"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8209],{8209:(e,t,o)=>{o.d(t,{gL:()=>c,getAuthToken:()=>n,isAuthenticated:()=>g,logout:()=>m,setAuthToken:()=>l,setUserData:()=>u,validateToken:()=>i});let a="authToken",r="userData";function n(){return localStorage.getItem(a)}function l(e){localStorage.setItem(a,e)}function c(){let e=localStorage.getItem(r);return e?JSON.parse(e):null}function u(e){let t={id:String(e.id).replace(/[<>"'&]/g,""),name:String(e.name).replace(/[<>"'&]/g,""),email:String(e.email).replace(/[<>"'&]/g,""),role:e.role};localStorage.setItem(r,JSON.stringify(t))}async function i(e){try{return(await fetch("".concat("https://lost-found-79xn.onrender.com","/api/auth/validate"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})).ok}catch(e){return!1}}function g(){return!!n()}function m(){localStorage.removeItem(a),localStorage.removeItem(r),localStorage.removeItem("userType"),localStorage.removeItem("userName"),localStorage.removeItem("token"),window.location.href="/"}}}]);