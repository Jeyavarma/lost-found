"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8209],{8209:(e,t,a)=>{a.d(t,{gL:()=>u,getAuthToken:()=>c,isAuthenticated:()=>g,logout:()=>s,setAuthToken:()=>l,setUserData:()=>i,validateToken:()=>m});var o=a(5704);let r=o.env.NEXT_PUBLIC_AUTH_TOKEN_KEY||"mcc_auth_token",n=o.env.NEXT_PUBLIC_USER_DATA_KEY||"mcc_user_data";function c(){return localStorage.getItem(r)}function l(e){localStorage.setItem(r,e)}function u(){let e=localStorage.getItem(n);return e?JSON.parse(e):null}function i(e){let t={id:String(e.id).replace(/[<>"'&]/g,""),name:String(e.name).replace(/[<>"'&]/g,""),email:String(e.email).replace(/[<>"'&]/g,""),role:e.role};localStorage.setItem(n,JSON.stringify(t))}async function m(e){try{return(await fetch("".concat("https://lost-found-79xn.onrender.com","/api/auth/validate"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})).ok}catch(e){return!1}}function g(){return!!c()}function s(){localStorage.removeItem(r),localStorage.removeItem(n),localStorage.removeItem("userType"),localStorage.removeItem("userName"),localStorage.removeItem("token"),window.location.href="/"}}}]);